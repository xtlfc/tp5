<!--pages/voice-call/voice-call.wxml-->
<view class="voice-call-container">
  <!-- èƒŒæ™¯ -->
  <view class="call-background">
    <view class="background-pattern"></view>
  </view>

  <!-- é€šè¯ä¿¡æ¯ -->
  <view class="call-info">
    <view class="caller-info">
      <image class="caller-avatar" src="{{callerInfo.avatarUrl}}" mode="aspectFill"></image>
      <view class="caller-details">
        <text class="caller-name">{{callerInfo.nickName}}</text>
        <text class="call-status">{{callStatus}}</text>
      </view>
    </view>
    <text class="call-duration">{{callDuration}}</text>
  </view>

  <!-- é€šè¯çŠ¶æ€æç¤º -->
  <view class="call-status-tip" wx:if="{{showStatusTip}}">
    <text class="tip-text">{{statusTipText}}</text>
  </view>

  <!-- æ§åˆ¶æŒ‰é’® -->
  <view class="control-buttons">
    <!-- éº¦å…‹é£å¼€å…³ -->
    <view class="control-btn {{isLocalAudioMuted ? 'active' : ''}}" bindtap="toggleAudio">
      <text class="btn-icon">{{isLocalAudioMuted ? 'ğŸ¤' : 'ğŸ¤'}}</text>
      <text class="btn-text">{{isLocalAudioMuted ? 'å¼€å¯' : 'å…³é—­'}}</text>
    </view>

    <!-- æ‰¬å£°å™¨å¼€å…³ -->
    <view class="control-btn {{isSpeakerOn ? 'active' : ''}}" bindtap="toggleSpeaker">
      <text class="btn-icon">{{isSpeakerOn ? 'ğŸ”Š' : 'ğŸ”Š'}}</text>
      <text class="btn-text">{{isSpeakerOn ? 'å…³é—­' : 'å¼€å¯'}}</text>
    </view>

    <!-- æŒ‚æ–­ç”µè¯ -->
    <view class="control-btn hangup" bindtap="hangup">
      <text class="btn-icon">ğŸ“</text>
      <text class="btn-text">æŒ‚æ–­</text>
    </view>
  </view>

  <!-- ç½‘ç»œçŠ¶æ€ -->
  <view class="network-status">
    <text class="network-text">ç½‘ç»œ: {{networkQuality}}</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">{{loadingText}}</text>
  </view>

  <!-- æ¥ç”µç•Œé¢ -->
  <view class="incoming-call" wx:if="{{isIncoming && !isAnswered}}">
    <view class="incoming-info">
      <image class="incoming-avatar" src="{{callerInfo.avatarUrl}}" mode="aspectFill"></image>
      <text class="incoming-name">{{callerInfo.nickName}}</text>
      <text class="incoming-text">æ¥ç”µ</text>
    </view>
    
    <view class="incoming-actions">
      <button class="answer-btn" bindtap="answerCall">
        <text class="answer-icon">ğŸ“</text>
        <text class="answer-text">æ¥å¬</text>
      </button>
      <button class="reject-btn" bindtap="rejectCall">
        <text class="reject-icon">ğŸ“</text>
        <text class="reject-text">æ‹’ç»</text>
      </button>
    </view>
  </view>
</view>