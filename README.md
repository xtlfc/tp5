# 微信交友小程序

一个基于微信小程序的交友应用，用户可以通过摇骰子匹配到同时段摇骰子点数相同的异性用户。

## 功能特性

- 🔐 微信授权登录
- 🎲 摇骰子匹配系统
- 📱 手机摇动检测
- 👥 异性用户匹配
- 💬 即时聊天功能
- 🔥 聊天消息看完即销毁
- 📍 基于地理位置的匹配
- 📹 视频通话功能
- 📞 语音通话功能
- 👤 用户资料编辑
- 🚫 黑名单功能
- ⚠️ 举报功能
- 📢 消息推送
- 📊 数据统计分析
- 🚀 性能优化
  - 图片懒加载
  - 列表虚拟滚动
  - 缓存策略优化
  - 网络请求优化

## 技术栈

- 微信小程序原生开发
- 云开发数据库
- 微信云函数
- 微信小程序地图API

## 项目结构

```
miniprogram/
├── pages/
│   ├── index/          # 首页（摇骰子）
│   ├── login/          # 登录页
│   ├── match/          # 匹配结果页
│   ├── chat/           # 聊天页
│   ├── profile/        # 个人资料页
│   ├── video-call/     # 视频通话页
│   ├── voice-call/     # 语音通话页
│   ├── edit-profile/   # 编辑资料页
│   ├── blacklist/      # 黑名单页
│   ├── report/         # 举报页
│   └── analytics/      # 数据分析页
├── components/
│   ├── lazy-image/     # 懒加载图片组件
│   └── virtual-list/   # 虚拟滚动列表组件
├── utils/
│   ├── cache/          # 缓存管理
│   ├── network/        # 网络请求优化
│   └── analytics/      # 数据分析工具
├── images/             # 图片资源
└── app.js              # 应用入口

cloudfunctions/
├── login/              # 登录云函数
├── match/              # 匹配云函数
├── chat/               # 聊天云函数
├── video-call/         # 视频通话云函数
├── voice-call/         # 语音通话云函数
├── push/               # 推送云函数
└── analytics/          # 数据分析云函数
```

## 安装和运行

1. 下载微信开发者工具
2. 导入项目
3. 配置云开发环境
4. 编译运行

## 使用说明

### 基础功能
1. 用户首次进入需要微信授权登录
2. 首页显示摇骰子界面，摇动手机或点击按钮开始摇骰子
3. 摇骰子完成后，系统匹配同时段点数相同的异性用户
4. 匹配成功后可以开始聊天
5. 聊天消息具有时效性，看完即销毁

### 高级功能
1. **视频/语音通话**：在聊天页面可以发起视频或语音通话
2. **用户资料编辑**：在个人资料页可以编辑头像、昵称、个人介绍等信息
3. **黑名单管理**：可以拉黑不想聊天的用户，支持批量管理
4. **举报功能**：可以举报违规用户，支持上传证据
5. **数据统计**：查看个人使用数据，包括匹配成功率、活跃时间等
6. **消息推送**：重要消息会通过微信模板消息推送通知

### 性能优化
1. **图片懒加载**：图片按需加载，提升页面性能
2. **虚拟滚动**：长列表使用虚拟滚动，减少内存占用
3. **智能缓存**：多级缓存策略，提升数据加载速度
4. **网络优化**：请求去重、重试机制、批量处理等优化
