<!--pages/video-call/video-call.wxml-->
<view class="video-call-container">
  <!-- ä¸»è§†é¢‘åŒºåŸŸ -->
  <view class="main-video-area">
    <live-pusher
      id="localVideo"
      class="local-video {{isLocalVideoMuted ? 'muted' : ''}}"
      url="{{pushUrl}}"
      mode="RTC"
      beauty="0"
      whiteness="0"
      aspect="9:16"
      device-position="front"
      bindstatechange="onLocalVideoStateChange"
      binderror="onLocalVideoError"
    ></live-pusher>

    <live-player
      id="remoteVideo"
      class="remote-video {{isRemoteVideoMuted ? 'muted' : ''}}"
      src="{{playUrl}}"
      mode="RTC"
      object-fit="contain"
      bindstatechange="onRemoteVideoStateChange"
      binderror="onRemoteVideoError"
    ></live-player>
  </view>

  <!-- é€šè¯ä¿¡æ¯ -->
  <view class="call-info">
    <view class="caller-info">
      <image class="caller-avatar" src="{{callerInfo.avatarUrl}}" mode="aspectFill"></image>
      <view class="caller-details">
        <text class="caller-name">{{callerInfo.nickName}}</text>
        <text class="call-status">{{callStatus}}</text>
      </view>
    </view>
    <text class="call-duration">{{callDuration}}</text>
  </view>

  <!-- æ§åˆ¶æŒ‰é’® -->
  <view class="control-buttons">
    <!-- æ‘„åƒå¤´å¼€å…³ -->
    <view class="control-btn {{isLocalVideoMuted ? 'active' : ''}}" bindtap="toggleVideo">
      <text class="btn-icon">{{isLocalVideoMuted ? 'ğŸ“¹' : 'ğŸ“¹'}}</text>
      <text class="btn-text">{{isLocalVideoMuted ? 'å¼€å¯' : 'å…³é—­'}}</text>
    </view>

    <!-- éº¦å…‹é£å¼€å…³ -->
    <view class="control-btn {{isLocalAudioMuted ? 'active' : ''}}" bindtap="toggleAudio">
      <text class="btn-icon">{{isLocalAudioMuted ? 'ğŸ¤' : 'ğŸ¤'}}</text>
      <text class="btn-text">{{isLocalAudioMuted ? 'å¼€å¯' : 'å…³é—­'}}</text>
    </view>

    <!-- åˆ‡æ¢æ‘„åƒå¤´ -->
    <view class="control-btn" bindtap="switchCamera">
      <text class="btn-icon">ğŸ”„</text>
      <text class="btn-text">åˆ‡æ¢</text>
    </view>

    <!-- æŒ‚æ–­ç”µè¯ -->
    <view class="control-btn hangup" bindtap="hangup">
      <text class="btn-icon">ğŸ“</text>
      <text class="btn-text">æŒ‚æ–­</text>
    </view>
  </view>

  <!-- é€šè¯çŠ¶æ€æç¤º -->
  <view class="call-status-tip" wx:if="{{showStatusTip}}">
    <text class="tip-text">{{statusTipText}}</text>
  </view>

  <!-- ç½‘ç»œçŠ¶æ€ -->
  <view class="network-status">
    <text class="network-text">ç½‘ç»œ: {{networkQuality}}</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">{{loadingText}}</text>
  </view>
</view>